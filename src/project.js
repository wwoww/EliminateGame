window.__require=function t(s,e,i){function o(r,c){if(!e[r]){if(!s[r]){var a=r.split("/");if(a=a[a.length-1],!s[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+r+"'")}}var u=e[r]={exports:{}};s[r][0].call(u.exports,function(t){return o(s[r][1][t]||t)},u,u.exports,t,s,e,i)}return e[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({Score:[function(t,s,e){"use strict";cc._RF.push(s,"936b9zTCoxNAawf6Q8k/hY9","Score"),cc.Class({extends:cc.Component,properties:{score:0},reward:0,onLoad:function(){},setReward:function(t){this.reward=t},updateScore:function(){var t=this.node.getComponent(cc.Label);this.score+=this.reward,t.string="Score:"+this.score}}),cc._RF.pop()},{}],Star:[function(t,s,e){"use strict";cc._RF.push(s,"a4a55DEbn5IJ5aWWngtYKa/","Star"),cc.Class({extends:cc.Component,properties:{icons:{default:[],type:cc.SpriteFrame},pos:{default:new cc.Vec2},number:0,sfIndex:0},onLoad:function(){this.initSpriteFrame()},initSpriteFrame:function(){this.sfIndex=function(t,s){var e=Math.random();return t+Math.floor((s-t)*e)}(0,this.number),this.getComponent(cc.Sprite).spriteFrame=this.icons[this.sfIndex]}}),cc._RF.pop()},{}],Time:[function(t,s,e){"use strict";cc._RF.push(s,"adfb6LK7QtEAaDGvUYv2r5v","Time"),cc.Class({extends:cc.Component,properties:{time:0},onLoad:function(){this.schedule(this.updataTime,1)},updataTime:function(){this.time++,this.getComponent(cc.Label).string="Time:"+this.time}}),cc._RF.pop()},{}],gameLayout:[function(t,s,e){"use strict";cc._RF.push(s,"92957fjTYRNvYdWoUhvChSU","gameLayout"),cc.Class({extends:cc.Component,properties:{Col:0,Row:0,Padding:0,SpacingX:0,SpacingY:0,star:{default:null,type:cc.Prefab},Score:{default:null,type:cc.Node}},reward:0,pSet:null,stars:null,mask:null,onLoad:function(){this.buildCoordinateSet(),this.init(),this.check()},init:function(){var t=this.node;this.mask=[],this.stars=[];for(var s=this.pSet,e=0;e<this.Row;e++){for(var i=[],o=[],n=0;n<this.Col;n++){var r=cc.instantiate(this.star);r.setPosition(s[e][n].x,s[e][n].y),t.addChild(r,0,"ele"),this.addTouchEvents(r),r.getComponent("Star").pos=cc.v2(e,n),i.push(r),o.push(0)}this.mask.push(o),this.stars.push(i)}},check:function(){this.checkConnected()&&this.delAndDrop()},buildCoordinateSet:function(){var t=cc.instantiate(this.star).getContentSize(),s=(this.node.width-(this.Row-1)*(this.SpacingX+t.width))/2,e=this.Padding+t.height/2;this.pSet=[];for(var i=0;i<this.Row;i++){for(var o=[],n=0;n<this.Col;n++){var r=cc.v2(s+i*(t.width+this.SpacingX),e+n*(t.height+this.SpacingY));window.console.log(r.toString()),o.push(r)}this.pSet.push(o)}},addTouchEvents:function(t){var s=null,e=null;window.console.log("m"+this),t.on("touchstart",function(e){t.select=!0,s=t.getComponent("Star").pos,window.console.log(s)},this),t.on("touchmove",function(s){if(t.select){var e=s.getLocationX(),i=s.getLocationY();t.setPosition(e,i),window.console.log(e+" "+i)}},this),t.on("touchend",function(i){t.select=!1;var o=i.getLocationX(),n=i.getLocationY();e=this.PositionToPos(o,n),window.console.log(e),this.isAround(s,e)&&void 0!==this.stars[e.x][e.y]?(window.console.log("isAround"),this.changeTwoPos(s,e),this.check()):t.setPosition(this.pSet[s.x][s.y])},this)},PositionToPos:function(t,s){var e=cc.instantiate(this.star).getContentSize();return cc.v2(Math.floor((t-this.Padding)/(e.width+this.SpacingX)),Math.floor((s-this.Padding)/(e.height+this.SpacingY)))},isAround:function(t,s){var e=Math.abs(s.x-t.x+(s.y-t.y));return window.console.log(e),1==e},changeTwoPos:function(t,s){this.stars[t.x][t.y].getComponent("Star").pos=s,this.stars[t.x][t.y].setPosition(this.pSet[s.x][s.y]),this.stars[s.x][s.y].getComponent("Star").pos=t,this.stars[s.x][s.y].setPosition(this.pSet[t.x][t.y]);var e=this.stars[t.x][t.y];this.stars[t.x][t.y]=this.stars[s.x][s.y],this.stars[s.x][s.y]=e},delAndDrop:function(){this.deleteConnected(),this.dropAndUpdata()},checkConnected:function(){var t=this.verticalCheckConnected(),s=this.horizontalCheckConnected();return this.reward=this.calScore(t+s),window.console.log(this.reward+"rew"),t+s>0},calScore:function(t){return 10*t},verticalCheckConnected:function(){for(var t,s,e,i=0,o=0;o<this.stars.length;o++)if(void 0!==this.stars[o][0]){t=this.stars[o][0].getComponent("Star").sfIndex,s=0;for(var n=1;n<=this.stars[o].length;n++)if(t!=(n==this.stars[o].length?-1:this.stars[o][n].getComponent("Star").sfIndex)){if((e=n)-s>=3)for(;s!=e;)this.mask[o][s]=1,s++,i++;(s=e)!=this.stars[o].length&&(t=this.stars[o][s].getComponent("Star").sfIndex)}}return i},horizontalCheckConnected:function(){for(var t,s,e=0,i=0;i<this.Col;i++)for(var o=0;o<this.Row;)if(void 0!==this.stars[o][i]){t=this.stars[o][i].getComponent("Star").sfIndex;var n=o;for(s=n;s<this.Row;){if(void 0===this.stars[s][i]){if(s-n>=3)for(;n!=s;)1!=this.mask[n][i]&&(this.mask[n][i]=1,e++),n++;break}if(t!=this.stars[s][i].getComponent("Star").sfIndex){if(s-n>=3)for(;n!=s;)1!=this.mask[n][i]&&(this.mask[n][i]=1,e++),n++;break}s++}if(s==this.Row&&s-n>=3)for(;n!=s;)1!=this.mask[n][i]&&(this.mask[n][i]=1,e++),n++;o=s}else o++;return e},deleteConnected:function(){for(var t=0;t<this.Row;t++)for(var s,e=0,i=!0,o=this.Col-1;o>=0;o--){if(1==this.mask[t][o]){i&&(e=o,i=!1);var n=cc.sequence(cc.blink(.2,1),cc.scaleBy(.5,0,0));this.stars[t][o].runAction(n)}(1!=this.mask[t][o-1]||o-1<0)&&0==i&&(s=o,this.stars[t].splice(s,e-s+1),i=!0),this.mask[t][o]=0}this.updateScore()},dropAndUpdata:function(){for(var t=cc.callFunc(function(t){this.check()},this),s=0;s<this.stars.length;s++)for(var e=0;e<this.stars[s].length;e++){if(s==this.stars.length-1&&e==this.stars[s].length-1)var i=cc.sequence(cc.moveTo(1,this.pSet[s][e]),t);else i=cc.moveTo(1,this.pSet[s][e]);this.stars[s][e].runAction(i),this.stars[s][e].getComponent("Star").pos=cc.v2(s,e)}},updateScore:function(){var t=this.Score.getComponent("Score");t.setReward(this.reward),t.updateScore()}}),cc._RF.pop()},{}],startGame:[function(t,s,e){"use strict";cc._RF.push(s,"a3a97U6fRBJwZWdhJx06jKn","startGame"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},startGame:function(){cc.director.loadScene("playScene",null)}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,s,e){"use strict";cc._RF.push(s,"77a54ELzCxKm78JWSXLeDUb","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["Score","Star","Time","gameLayout","startGame","use_v2.0.x_cc.Toggle_event"]);